DROP TABLE IF EXISTS ACCOUNT;
DROP TABLE IF EXISTS ACCOUNT_TYPES;
DROP TABLE IF EXISTS CUSTOMER;

CREATE TABLE ACCOUNT_TYPES (
  ID BIGINT(20) NOT NULL  PRIMARY KEY,
   NAME  VARCHAR(255) DEFAULT NULL
);

ALTER TABLE ACCOUNT_TYPES ADD UNIQUE (ID,NAME);

CREATE TABLE  CUSTOMER  (
   ID  BIGINT(20) NOT NULL PRIMARY KEY,
   EMAIL  VARCHAR(255) DEFAULT NULL,
   FIRST_NAME  VARCHAR(255) DEFAULT NULL,
   LAST_NAME  VARCHAR(255) DEFAULT NULL,
   PASSWORD  VARCHAR(255) DEFAULT NULL,
   DATE_OF_BIRTH DATE NOT NULL,
   ADDRESS  VARCHAR(255) NOT NULL,
   LAST_LOGIN DATE NOT NULL,
   STATUS TINYINT NOT NULL DEFAULT 0
);

ALTER TABLE CUSTOMER ADD UNIQUE (EMAIL);
ALTER TABLE CUSTOMER ADD UNIQUE (FIRST_NAME, ADDRESS, DATE_OF_BIRTH);


CREATE TABLE  ACCOUNT (
   ID  BIGINT(20) NOT NULL PRIMARY KEY,
   CUSTOMER_ID  BIGINT(20) NOT NULL,
   ACCOUNT_TYPE  BIGINT(20) NOT NULL,
   BALANCE BIGINT(20)  NOT NULL DEFAULT 0,
   INT_RATE INT NOT NULL
);

ALTER TABLE ACCOUNT ADD UNIQUE (ID, CUSTOMER_ID, ACCOUNT_TYPE);

ALTER TABLE ACCOUNT ADD CONSTRAINT FK_ACCOUNT_CUSTOMER FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(ID);

ALTER TABLE ACCOUNT ADD CONSTRAINT FK_ACCOUNT_ACCOUNT_TYPE FOREIGN KEY (ACCOUNT_TYPE) REFERENCES ACCOUNT_TYPES(ID);

INSERT INTO ACCOUNT_TYPES (ID,NAME)VALUES (1257854,'SAVINGS');
